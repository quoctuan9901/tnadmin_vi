/**
* docViewer Plugin
* Licensed by Pháº¡m Giang Pro @2017
* http://www.phamgiang.pro/thu-vien/javascript/1-ckeditor-plugin-google-document-viewer.html
*/
CKEDITOR.plugins.add("docViewer",{icons:"docViewer",lang:"en,ru,vi",hidpi:!0,version:1.15,init:function(e){e.addCommand("docViewer",new CKEDITOR.dialogCommand("docViewer")),e.ui.addButton("docViewer",{label:e.lang.docViewer.button,command:"docViewer",toolbar:"insert,10",icon:this.path+"icons/"+(CKEDITOR.env.hidpi?"hidpi/":"")+"docViewer.png"}),e.widgets.add("docViewer",{draggable:!1,mask:!0,dialog:"docViewer",allowedContent:{div:{styles:"margin,font-size,color,text-decoration,max-width,height,float",attributes:"*",classes:"vDocViewer"},"div a":{attributes:"*"}},template:'<div style="display:inherit; clear: both; text-align:center; max-width:100%; border: 1px dotted #AEAEAE" class="vDocViewer"></div>',upcast:function(e){return"div"==e.name&&e.hasClass("vDocViewer")},init:function(){this.on("dialog",function(e){e.data.widget=this},this)}}),CKEDITOR.dialog.add("docViewer",function(e){return{title:e.lang.docViewer.title,minWidth:CKEDITOR.env.ie&&CKEDITOR.env.quirks?468:450,height:190,onLoad:function(){},contents:[{label:e.lang.common.generalTab,id:"pluginDocViewer",elements:[{type:"textarea",id:"documents",className:"docViewer",label:e.lang.docViewer.selectDocument,onChange:function(e){},required:!0,validate:function(){this.getDialog().getContentElement("pluginDocViewer","documents").getValue();if(0===this.getValue().length)return alert(e.lang.docViewer.alertUrl),!1},commit:function(e){var t=this.getDialog(),i=t.getContentElement("pluginDocViewer","txtWidth").getValue(),n=t.getContentElement("pluginDocViewer","txtHeight").getValue(),l=encodeURIComponent(t.getValueOf("pluginDocViewer","documents"));html='<iframe src="http://docs.google.com/viewer?url='+l+'&amp;embedded=true" style="border: none;" width="'+t.getValueOf("pluginDocViewer","txtWidth")+'" height="'+t.getValueOf("pluginDocViewer","txtHeight")+'"></iframe>',e.element.$.firstChild&&e.element.$.removeChild(e.element.$.firstChild),e.element.appendHtml(html),e.setData("txtWidth",i),e.setData("txtHeight",n),e.setData("txtUrl",this.getValue()),e.element.data("txtWidth",i),e.element.data("txtHeight",n),e.element.data("txtUrl",this.getValue())}},{type:"hbox",widths:["25%","25%","50%"],id:"docViewerSize",className:"docViewer",children:[{type:"text",width:"100%",id:"txtWidth",label:e.lang.common.width+" (pixcel)",default:710,required:!0,validate:function(){if(0===this.getValue().length)return alert(e.lang.docViewer.alertWidth),!1}},{type:"text",id:"txtHeight",width:"100%",label:e.lang.common.height+" (pixcel)",default:920,required:!0,validate:function(){if(0===this.getValue().length)return alert(e.lang.docViewer.alertHeight),!1}},{type:"button",id:"browse",width:"100%",style:"display:inline-block;margin-top:20px; float:right",align:"center",label:e.lang.common.browseServer,hidden:!0,filebrowser:"pluginDocViewer:documents"}]},{type:"html",id:"powerBy",html:''}]}],onOk:function(e){},onShow:function(){var e={txtUrl:this.widget.element.data("txtUrl")||"",txtWidth:this.widget.element.data("txtWidth")||710,txtHeight:this.widget.element.data("txtHeight")||920};this.getContentElement("pluginDocViewer","txtWidth").setValue(e.txtWidth),this.getContentElement("pluginDocViewer","txtHeight").setValue(e.txtHeight),this.getContentElement("pluginDocViewer","documents").setValue(e.txtUrl),this.widget.setData(e)}}})}});